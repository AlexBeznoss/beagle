name: RubocopBrancher
on: pull_request

env:
  RAILS_ENV: test

jobs:
  brancher:
    name: Linters
    runs-on: ubuntu-latest
    if: ${{ github.event.pull_request }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Ruby and install gems
        uses: ruby/setup-ruby@v1
        with:
          bundler-cache: false

      - name: Install gems
        run: bundle install

      - name: Run linters
        run: |
          changed_filed=$(git diff --name_only master)
          has_issues=$(bundle exec rubocop --fail-fast --force-exclusion $changed_filed --format=github)

          if [[ $has_issues ]]; then
            echo "Has issues"
          else
            echo "Has no issues"
          fi

